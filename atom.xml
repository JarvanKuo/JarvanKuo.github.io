<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>JK的技术博客</title>
  
  <subtitle>技术博客</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://JarvanKuo.github.io/"/>
  <updated>2019-09-30T02:52:44.000Z</updated>
  <id>https://JarvanKuo.github.io/</id>
  
  <author>
    <name>Jarvan Kuo</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>hexo笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/18/hexo%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/18/hexo笔记/</id>
    <published>2019-09-18T05:14:40.000Z</published>
    <updated>2019-09-30T02:52:44.000Z</updated>
    
    <content type="html"><![CDATA[<p>hexo的一些配置和命令</p><a id="more"></a><h2 id="hexo-常用指令"><a href="#hexo-常用指令" class="headerlink" title="hexo 常用指令"></a>hexo 常用指令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo new <span class="string">"post title with whitespace"</span> // 新增md文章</span><br><span class="line">hexo clean // 清除</span><br><span class="line">hexo g // 生成静态文件。</span><br><span class="line">hexo g -d // 文件生成后立即部署网站</span><br></pre></td></tr></table></figure><h2 id="站内文章跳转"><a href="#站内文章跳转" class="headerlink" title="站内文章跳转"></a>站内文章跳转</h2><p>通过内置的标签插件的语法post_link来实现引用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% post_link 文章文件名（不要后缀） 文章标题（可选） %&#125;</span><br></pre></td></tr></table></figure><h2 id="hexo安装"><a href="#hexo安装" class="headerlink" title="hexo安装"></a>hexo安装</h2><p>请看 <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">官网</a></p><h2 id="NexT主题"><a href="#NexT主题" class="headerlink" title="NexT主题"></a>NexT主题</h2><p>使用流行的NexT，<a href="http://theme-next.iissnan.com/" target="_blank" rel="noopener">NexT官网</a></p><h2 id="默认主题"><a href="#默认主题" class="headerlink" title="默认主题"></a>默认主题</h2><p>插件扩展请看 <a href="https://hans2936.github.io/2017/10/22/PageLog/" target="_blank" rel="noopener">个人网站的功能插件</a></p><h2 id="评论插件-gitalk"><a href="#评论插件-gitalk" class="headerlink" title="评论插件-gitalk"></a>评论插件-gitalk</h2><p><a href="https://jinfagang.github.io/2018/10/07/%E7%BB%88%E4%BA%8E%EF%BC%81%EF%BC%81%EF%BC%81%E8%AE%B0%E5%BD%95%E5%A6%82%E4%BD%95%E5%9C%A8hexo-next%E4%B8%BB%E9%A2%98%E4%B8%8B%E9%85%8D%E7%BD%AEgitalk%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" target="_blank" rel="noopener">记录如何在hexo next主题下配置gitalk评论系统</a></p><h2 id="修改内容区宽度"><a href="#修改内容区宽度" class="headerlink" title="修改内容区宽度"></a>修改内容区宽度</h2><p><a href="https://zuiyu1818.cn/posts/NexT_codewidth.html" target="_blank" rel="noopener">NexT | 修改内容区域的宽度</a></p><h2 id="添加文章阴影"><a href="#添加文章阴影" class="headerlink" title="添加文章阴影"></a>添加文章阴影</h2><p><a href="https://blog.csdn.net/mqdxiaoxiao/article/details/93797964" target="_blank" rel="noopener">Hexo博客NexT主题下添加文章边框阴影效果</a></p><h2 id="文章摘要设置"><a href="#文章摘要设置" class="headerlink" title="文章摘要设置"></a>文章摘要设置</h2><p><a href="https://blog.csdn.net/lewky_liu/article/details/81277337" target="_blank" rel="noopener">站点首页不显示文章全文</a></p><p>修改配置文件_config.yml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Automatically Excerpt. Not recommend.</span></span><br><span class="line"><span class="comment"># Please use &lt;!-- more --&gt; in the post to control excerpt accurately.</span></span><br><span class="line"><span class="attr">auto_excerpt:</span></span><br><span class="line"><span class="attr">  enable:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">  length:</span> <span class="number">150</span></span><br></pre></td></tr></table></figure><p><strong><em>注：</em></strong>使用<code>&lt;!-- more --&gt;</code>标志来精确控制文章的摘要预览，通常在文章开头写一下概要。</p><h2 id="一篇文章多个-categories"><a href="#一篇文章多个-categories" class="headerlink" title="一篇文章多个 categories"></a>一篇文章多个 categories</h2><p><a href="https://www.jianshu.com/p/bff1b1845ac9" target="_blank" rel="noopener">Hexo 一篇文章多个 categories</a>:这里yaml语法错误，列表-的后面没有空格</p><p><a href="https://www.jianshu.com/p/02e4a80026d0?from=timeline&isappinstalled=0" target="_blank" rel="noopener">YAML配置文件</a></p><ul><li><p>子分类</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">categories:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">Java</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">Servlet</span></span><br><span class="line"><span class="comment"># 或者下面写法</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">[Java,</span> <span class="string">Servlet]</span></span><br></pre></td></tr></table></figure></li></ul><ul><li><p>同级多个分类</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">categories:</span> <span class="string">[[Java],</span> <span class="string">[Servlet]]</span> <span class="comment"># yaml兼容Json的语法，直接写Json串</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">[[Java,</span> <span class="string">Servlet],</span> <span class="string">[Servlet2]]</span> <span class="comment"># 包含子分类</span></span><br><span class="line"><span class="comment"># 或者下面写法</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">[Java]</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">[Servlet]</span></span><br><span class="line"><span class="comment"># 下面包含子分类</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">[Java,</span> <span class="string">Servlet]</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">[Programming]</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;hexo的一些配置和命令&lt;/p&gt;
    
    </summary>
    
    
      <category term="建站" scheme="https://JarvanKuo.github.io/categories/%E5%BB%BA%E7%AB%99/"/>
    
      <category term="hexo" scheme="https://JarvanKuo.github.io/categories/%E5%BB%BA%E7%AB%99/hexo/"/>
    
    
      <category term="hexo" scheme="https://JarvanKuo.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>redis笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/redis%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/redis笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:57:56.000Z</updated>
    
    <content type="html"><![CDATA[<p>redis笔记！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.iteye.com/blog/jinnianshilongnian-2186787" target="_blank" rel="noopener">第三章 Redis/SSDB+Twemproxy安装与使用</a></p><p><a href="https://www.jianshu.com/p/fcc8894923f7" target="_blank" rel="noopener">nohup和&amp;使用</a></p><p><a href="https://www.iteye.com/blog/zjjndnr-2386573" target="_blank" rel="noopener">Twemproxy-缓存代理分片机制</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>win10 下 wsl 环境 ubuntu 的 redis</p><h2 id="Redis安装与使用"><a href="#Redis安装与使用" class="headerlink" title="Redis安装与使用"></a>Redis安装与使用</h2><ol><li><p>下载redis并安装</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/servers/  </span><br><span class="line">wget https://github.com/antirez/redis/archive/2.8.19.tar.gz  </span><br><span class="line">tar -xvf 2.8.19.tar.gz  </span><br><span class="line"><span class="built_in">cd</span> redis-2.8.19/  </span><br><span class="line">make</span><br></pre></td></tr></table></figure></li><li><p>后台启动Redis服务器</p><p> 使用 nohup 和 &amp; 指令：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nohup /usr/servers/redis-2.8.19/src/redis-server  /usr/servers/redis-2.8.19/redis.conf &amp;</span><br><span class="line">`</span><br></pre></td></tr></table></figure></li><li><p>查看是否启动成功</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -ef | grep redis</span><br></pre></td></tr></table></figure></li></ol><ol start="4"><li><p>进入客户端并测试</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/usr/servers/redis-2.8.19/src/redis-cli  -p 6379  </span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> i 1  </span><br><span class="line">OK  </span><br><span class="line">127.0.0.1:6379&gt; get i  </span><br><span class="line"><span class="string">"1"</span> </span><br><span class="line">127.0.0.1:6379&gt; quit  <span class="comment"># quit 退出 redis 客户端</span></span><br></pre></td></tr></table></figure></li><li><p>redis客户端显示中文</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-cli  -- raw  <span class="comment"># 默认redis不转义中文的，需要加上 --raw</span></span><br></pre></td></tr></table></figure></li><li><p>redis-cli查看所有的keys及清空所有的数据</p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">keys * <span class="comment"># 查看所有keys</span></span><br><span class="line">flushall  <span class="comment"># 清空所有数据</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="Redis主从"><a href="#Redis主从" class="headerlink" title="Redis主从"></a>Redis主从</h2><ol><li><p>基本设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#端口设置，默认6379  </span><br><span class="line">port 6379  </span><br><span class="line">#日志文件，默认/dev/null  </span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"></span><br><span class="line">#内存大小对应关系  </span><br><span class="line"># 1k =&gt; 1000 bytes  </span><br><span class="line"># 1kb =&gt; 1024 bytes  </span><br><span class="line"># 1m =&gt; 1000000 bytes  </span><br><span class="line"># 1mb =&gt; 1024*1024 bytes  </span><br><span class="line"># 1g =&gt; 1000000000 bytes  </span><br><span class="line"># 1gb =&gt; 1024*1024*1024 bytes  </span><br><span class="line"></span><br><span class="line">#设置Redis占用100mb的大小  </span><br><span class="line">maxmemory  100mb  </span><br><span class="line"></span><br><span class="line">#如果内存满了就需要按照如相应算法进行删除过期的/最老的  </span><br><span class="line">#volatile-lru 根据LRU算法移除设置了过期的key  </span><br><span class="line">#allkeys-lru  根据LRU算法移除任何key(包含那些未设置过期时间的key)  </span><br><span class="line">#volatile-random/allkeys-&gt;random 使用随机算法而不是LRU进行删除  </span><br><span class="line">#volatile-ttl 根据Time-To-Live移除即将过期的key   </span><br><span class="line">#noeviction   永不过期，而是报错  </span><br><span class="line">maxmemory-policy volatile-lru  </span><br><span class="line"></span><br><span class="line">#Redis并不是真正的LRU/TTL，而是基于采样进行移除的，即如采样10个数据移除其中最老的/即将过期的  </span><br><span class="line">maxmemory-samples 10</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>Redis主从</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#在配置文件中挂载主从，不推荐这种方式，我们实际应用时Redis可能是会宕机的  </span><br><span class="line">slaveof masterIP masterPort  </span><br><span class="line">#从是否只读，默认yes  </span><br><span class="line">slave-read-only yes  </span><br><span class="line">#当从失去与主的连接或者复制正在进行时，从是响应客户端（可能返回过期的数据）还是返回“SYNC with master in progress”错误，默认yes响应客户端  </span><br><span class="line">slave-serve-stale-data yes  </span><br><span class="line">#从库按照默认10s的周期向主库发送PING测试连通性  </span><br><span class="line">repl-ping-slave-period 10  </span><br><span class="line">#设置复制超时时间（SYNC期间批量I/O传输、PING的超时时间），确保此值大于repl-ping-slave-period  </span><br><span class="line">#repl-timeout 60  </span><br><span class="line">#当从断开与主的连接时的复制缓存区，仅当第一个从断开时创建一个，缓存区越大从断开的时间可以持续越长  </span><br><span class="line"># repl-backlog-size 1mb  </span><br><span class="line">#当从与主断开持续多久时清空复制缓存区，此时从就需要全量复制了，如果设置为0将永不清空    </span><br><span class="line"># repl-backlog-ttl 3600  </span><br><span class="line">#slave客户端缓存区，如果缓存区超过256mb将直接断开与从的连接，如果持续60秒超过64mb也会断开与从的连接  </span><br><span class="line">client-output-buffer-limit slave 256mb 64mb 60</span><br></pre></td></tr></table></figure><p>设置主从</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/servers/redis-2.8.19  </span><br><span class="line">cp redis.conf redis_6660.conf  </span><br><span class="line">cp redis.conf redis_6661.conf  </span><br><span class="line"><span class="comment"># 将端口分别改为port 6660和port 6661</span></span><br><span class="line">vim redis_6660.conf  </span><br><span class="line">vim redis_6661.conf  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动</span></span><br><span class="line">nohup /usr/servers/redis-2.8.19/src/redis-server  /usr/servers/redis-2.8.19/redis_6660.conf &amp;  </span><br><span class="line">nohup /usr/servers/redis-2.8.19/src/redis-server  /usr/servers/redis-2.8.19/redis_6661.conf &amp; </span><br><span class="line"><span class="comment"># 查看是否启动成功</span></span><br><span class="line">ps -aux | grep redis  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入从客户端，挂主（不在配置文件设置 slaveof masterIP masterPort ）</span></span><br><span class="line">/usr/servers/redis-2.8.19/src/redis-cli  -p 6661  </span><br><span class="line">127.0.0.1:6661&gt; slaveof 127.0.0.1 6660  </span><br><span class="line">OK  </span><br><span class="line">127.0.0.1:6661&gt; info replication  </span><br><span class="line"><span class="comment"># Replication  </span></span><br><span class="line">role:slave </span><br><span class="line">...</span><br></pre></td></tr></table></figure></li><li><p>Redis持久化</p><p>为了防止数据丢失，可以挂载一个从（叶子节点）只进行持久化存储工作。</p><p>Redis持久化有RDB快照模式和AOF追加模式。</p></li><li><p>Redis动态调整配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6660&gt; config get maxmemory  </span><br><span class="line">1) <span class="string">"maxmemory"</span>  </span><br><span class="line">2) <span class="string">"10485760"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调整配置值</span></span><br><span class="line">127.0.0.1:6660&gt; config <span class="built_in">set</span> maxmemory 20971520  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 上述命令重启redis后该配置会丢失，可以执行如下命令重写配置文件</span></span><br><span class="line">127.0.0.1:6660&gt; config rewrite</span><br></pre></td></tr></table></figure></li></ol><h2 id="Redis集群"><a href="#Redis集群" class="headerlink" title="Redis集群"></a>Redis集群</h2><p>一旦涉及到一台物理机无法存储的情况就需要考虑使用分片机制将数据存储到多台服务器，可以说是Redis集群。</p><p>利用 Twemproxy 实现分片、减少连接数、Hash Tag 分片逻辑。</p><h3 id="Twemproxy-代理"><a href="#Twemproxy-代理" class="headerlink" title="Twemproxy 代理"></a>Twemproxy 代理</h3><ol><li><p>Twemproxy 配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置文件</span></span><br><span class="line">vim /usr/servers/twemproxy-0.4.0/conf/nutcracker.yml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server1:</span></span><br><span class="line"><span class="attr">  listen:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:1111</span>  <span class="comment">## 监听地址和端口</span></span><br><span class="line"><span class="attr">  hash:</span> <span class="string">fnv1a_64</span>  <span class="comment">## 散列算法</span></span><br><span class="line"><span class="attr">  distribution:</span> <span class="string">ketama</span>  <span class="comment">## 分片的算法，有ketama（一致性hash）、module（取模）、random（随机）三种算法</span></span><br><span class="line"><span class="comment">#  auto_eject_hosts: true  ## 是否在节点无法响应时自动从服务器列表中剔除，重新响应时自动加入服务器列表中</span></span><br><span class="line"><span class="comment">#  timeout: 1000</span></span><br><span class="line"><span class="attr">  hash_tag:</span> <span class="string">"::"</span></span><br><span class="line"><span class="attr">  redis:</span> <span class="literal">true</span>  <span class="comment">## 后端代理的是否为redis</span></span><br><span class="line"><span class="attr">  servers:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:6660:1</span> <span class="string">server1</span></span><br><span class="line"><span class="bullet">   -</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="string">:6661:1</span> <span class="string">server2</span></span><br></pre></td></tr></table></figure></li><li><p>Twemproxy 启动</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/usr/servers/twemproxy-0.4.0/src/nutcracker  -d -c /usr/servers/twemproxy-0.4.0/conf/nutcracker.yml</span><br><span class="line">ps -aux | grep nutcracker</span><br><span class="line"><span class="comment"># 启动 Redis 客户端对应端口，查看是否代理成功</span></span><br><span class="line">/usr/servers/redis-2.8.19/src/redis-cli  -p 1111</span><br></pre></td></tr></table></figure><p>或者配置启动/重启/停止脚本方便操作 </p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x /usr/servers/twemproxy-0.4.0/scripts/nutcracker.init   </span><br><span class="line">vim /usr/servers/twemproxy-0.4.0/scripts/nutcracker.init</span><br></pre></td></tr></table></figure></li></ol><ul><li><p>将OPTIONS改为 OPTIONS=”-d -c /usr/local/twemproxy/conf/nutcracker.yml”</p></li><li><p>注释掉. /etc/rc.d/init.d/functions；</p></li><li><p>将daemon –user ${USER} ${prog} $OPTIONS改为${prog} $OPTIONS；</p><p>[报错]：若nutcracker没设置为全局变量，则会报此错</p><p> nutcracker: command not found</p><p>写了全路径：/usr/servers/twemproxy-0.4.0/src/${prog} $OPTIONS</p></li><li><p>将killproc改为killall。</p><p>这样就可以使用如下脚本进行启动、重启、停止了。</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nutcracker.init &#123;start|stop|status|restart|reload|condrestart&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;redis笔记！&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据库" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="redis" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/redis/"/>
    
    
      <category term="redis" scheme="https://JarvanKuo.github.io/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>SSDB数据库笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/SSDB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/SSDB数据库笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:58:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>SSDB：一个高性能的支持丰富数据结构的 NoSQL 数据库, 用于替代 Redis.</p><a id="more"></a><p>参考文献：</p><p><a href="http://ssdb.io/zh_cn/" target="_blank" rel="noopener">SSDB官网</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>win10 下 wsl 环境 ubuntu 的 ssdb</p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>配置文件使用Tab而不是空格做缩排（复制到配置文件后请把空格替换为Tab）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">work_dir = /usr/data/ssdb_8883  </span><br><span class="line">pidfile = /usr/data/ssdb_8883.pid  </span><br><span class="line">  </span><br><span class="line">server:  </span><br><span class="line">        ip: 0.0.0.0  </span><br><span class="line">        port: 8883  </span><br><span class="line">        allow: 127.0.0.1  </span><br><span class="line">        allow: 192.168  </span><br><span class="line">  </span><br><span class="line">replication:  </span><br><span class="line">        binlog: yes  </span><br><span class="line">        sync_speed: -1  </span><br><span class="line">        slaveof:  </span><br><span class="line">                type: sync  </span><br><span class="line">                ip: 127.0.0.1  </span><br><span class="line">                port: 8881  </span><br><span class="line">  </span><br><span class="line">logger:  </span><br><span class="line">        level: error  </span><br><span class="line">        output: /usr/data/ssdb_8883.log  </span><br><span class="line">        rotate:  </span><br><span class="line">                size: 1000000000  </span><br><span class="line">  </span><br><span class="line">leveldb:  </span><br><span class="line">        cache_size: 500  </span><br><span class="line">        block_size: 32  </span><br><span class="line">        write_buffer_size: 64  </span><br><span class="line">        compaction_speed: 1000  </span><br><span class="line">        compression: yes</span><br></pre></td></tr></table></figure><h2 id="启动服务器"><a href="#启动服务器" class="headerlink" title="启动服务器"></a>启动服务器</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nohup /usr/servers/ssdb-1.8.2/ssdb-server  /usr/chapter7/ssdb_desc_8883.conf &amp;  </span><br><span class="line">ps -aux | grep ssdb <span class="comment"># 命令看是否启动了</span></span><br><span class="line">tail -f nohup.out <span class="comment"># 查看错误信息</span></span><br></pre></td></tr></table></figure><h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><p>ssdb-server 是服务器的程序, ssdb-cli 是命令⾏的客户端</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/servers/ssdb-1.8.2/tools/ssdb-cli -p 8888  </span><br><span class="line"><span class="comment"># 因为SSDB支持Redis协议，所以用Redis客户端也可以访问</span></span><br><span class="line">/usr/servers/redis-2.8.19/src/redis-cli  -p 8888</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SSDB：一个高性能的支持丰富数据结构的 NoSQL 数据库, 用于替代 Redis.&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据库" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="SSDB" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/SSDB/"/>
    
    
      <category term="SSDB" scheme="https://JarvanKuo.github.io/tags/SSDB/"/>
    
  </entry>
  
  <entry>
    <title>java8新特性</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/java8%E6%96%B0%E7%89%B9%E6%80%A7/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/java8新特性/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T12:14:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>java8新特性：函数式编程，stream流，<em>Optional</em>  类！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.cnblogs.com/zhangboyu/p/7580262.html" target="_blank" rel="noopener">理解、学习与使用 Java 中的 Optional</a></p><p><a href="https://www.jianshu.com/p/eb331282f2f3" target="_blank" rel="noopener">Java8之Stream流（一）基础体验</a></p><p><a href="https://blog.csdn.net/Mark_Chao/article/details/80810030" target="_blank" rel="noopener">java8 stream流操作的flatMap（流的扁平化）</a></p><p><a href="https://www.cnblogs.com/kangkaii/p/8419082.html" target="_blank" rel="noopener">java中使用Lambda表达式的5种语法</a></p><h2 id="Lambda语法"><a href="#Lambda语法" class="headerlink" title="Lambda语法"></a>Lambda语法</h2><ul><li><p>标准写法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Arrays.sort(arr, (String m, String n) -&gt; Integer.compare(m.length(), n.length()));</span><br></pre></td></tr></table></figure><p>lambda表达式的标准写法由下面几点构成：</p><ul><li>以逗号分隔，以（）关闭的形参：<code>(Dog m, Dog n)</code></li><li>箭头标记：<code>-&gt;</code></li><li>主体部分则是一个单表达式或者声明代码块。如下是单表达式形式：<code>Integer.compare(m.getWeight(), n.getWeight())</code></li></ul></li><li><p>参数类型可以推断</p><p>如果参数的类型可以根据上下文推断出来，则可以省略掉类型</p></li><li><p>存在多行代码</p><p>需要{} 括起来，且代码应该有明确的返回语句</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Arrays.sort(arr, (String m, String n) -&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (m.length() &gt; n.length())</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li><li><p>单个参数并可推断类型</p><p>可以省略参数 “x” 的括号</p></li><li><p>方法引用</p><p>写成::形式，并省略参数。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stream.forEach(System.out::println);</span><br></pre></td></tr></table></figure></li><li><p>没有参数</p><p><code>() -&gt; {for(int i=0; i&lt;10; i++) doSomthing();}</code></p></li></ul><h2 id="Optional-类"><a href="#Optional-类" class="headerlink" title="Optional 类"></a>Optional 类</h2><p>包含有可选值的包装类，既可以含有对象也可以为空。</p><h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><ul><li><p>ofNullable() </p><p>创建Optional对象：传入的对象即可能是 <em>null</em> 也可能是非 null，不会抛出异常NullPointerException</p></li><li><p>ifPresent()</p><p>选择性执行语句：该方法除了执行检查，还接受一个<em>Consumer(消费者</em>) 参数，如果对象不是空的，就对执行传入的 Lambda 表达式：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opt.ifPresent( u -&gt; assertEquals(user.getEmail(), u.getEmail()));</span><br></pre></td></tr></table></figure><p>这个例子中，只有 user 用户不为 null 的时候才会执行断言。</p></li><li><p>orElseGet()</p><p>返回默认值：这个方法会在有值的时候返回值，如果没有值，它会执行作为参数传入的 <em>Supplier(供应者)</em> 函数式接口，并将返回其执行结果：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User result = Optional.ofNullable(user).orElseGet( () -&gt; user2);</span><br></pre></td></tr></table></figure><p><strong>orElse() 和 orElseGet() 的不同之处：</strong> <em>Optional</em>  对象返回非空值后，<em>orElse()</em> 方法仍然创建了 默认值 对象，而orElseGet() 方法不创建 默认值 对象。</p></li><li><p><em>orElseThrow()</em> </p><p>在对象为空的时候抛出异常，而不是返回备选的值：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span>(expected = IllegalArgumentException.class)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">whenThrowException_thenOk</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User result = Optional.ofNullable(user)</span><br><span class="line">      .orElseThrow( () -&gt; <span class="keyword">new</span> IllegalArgumentException());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个方法让我们有更丰富的语义，可以决定抛出什么样的异常，而不总是抛出 <em>NullPointerException</em>。</p></li><li><p>map()</p></li><li><p>filter()</p></li><li><p>Optional 类的链式方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String result = Optional.ofNullable(user)</span><br><span class="line">  .flatMap(User::getAddress)</span><br><span class="line">  .flatMap(Address::getCountry)</span><br><span class="line">  .map(Country::getIsocode)</span><br><span class="line">  .orElse(<span class="string">"default"</span>);</span><br></pre></td></tr></table></figure></li></ul><h2 id="Stream流"><a href="#Stream流" class="headerlink" title="Stream流"></a>Stream流</h2><ul><li><p>概念</p><p>Java 8 中的 Stream 是对集合（Collection）对象功能的增强</p><ul><li>专注于对集合对象进行各种非常便利、高效的聚合操作（aggregate operation）</li><li>大批量数据操作 (bulk data operation)</li><li>支持 Lambda 表达式</li><li>不是集合元素，它不是数据结构并不保存数据，它是有关算法和计算的</li><li>作用更像一个高级版本的 Iterator，与迭代器不同点，Stream 可以并行化操作，迭代器只能命令式地、串行化操作</li><li>Stream 的并行操作依赖于 Java7 中引入的 Fork/Join 框架（JSR166y）来拆分任务和加速处理过程</li></ul></li><li><p>“终端操作”&amp;”中间操作”</p><ul><li><p>终端操作： 会消费流，这种操作会产生一个结果的</p><p> iterator()、 spliterator()、min()、max()、forEach()</p></li><li><p>中间操作：会产生另一个流，类似管道</p></li></ul></li><li><p>缩减操作</p><p>缩减操作的三个约束条件</p><ul><li>无状态</li><li>不干预</li><li>关联性</li></ul><p>reduce()-通用的方法，而min()和max()，count()这些操作称为特例缩减。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">T <span class="title">reduce</span><span class="params">(T identity, BinaryOperator&lt;T&gt; accumulator)</span></span>;<span class="comment">//1</span></span><br><span class="line"><span class="function">Optional&lt;T&gt; <span class="title">reduce</span><span class="params">(BinaryOperator&lt;T&gt; accumulator)</span></span>;<span class="comment">//2</span></span><br></pre></td></tr></table></figure><p>第一个版本的identity为初始化值（兼容单个值的情况），求和的时候为0，求积的时候它的值为1。</p><p>其中的accumulator是一个BinaryOperator<t>的类型，他是java.util.function包中声明的函数式接口，它扩展了BiFunction函数式接口.</t></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BinaryOperator</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">BiFunction</span>&lt;<span class="title">T</span>,<span class="title">T</span>,<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">BiFunction</span>&lt;<span class="title">T</span>, <span class="title">U</span>, <span class="title">R</span>&gt; </span>&#123;</span><br><span class="line">   <span class="function">R <span class="title">apply</span><span class="params">(T t, U u)</span></span>;<span class="comment">//notice</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>apply()对他的两个操作数(t,u)应用到同一个函数上，并返回结果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 直接函数式编程</span><br><span class="line">reduce((a, b) -&gt; a + b)</span><br></pre></td></tr></table></figure></li><li><p>并行流</p><p>对流调用一下parallel()，或者Collection.parallelStream()</p><p>在reduce()的第三版本比较适合并行流，accumulator被称为累加器， combiner被称为合成器， combiner定义的函数将accumulator提到的两个值合并起来</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Stream</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">BaseStream</span>&lt;<span class="title">T</span>, <span class="title">Stream</span>&lt;<span class="title">T</span>&gt;&gt; </span>&#123;</span><br><span class="line"><span class="comment">//、、、忽略其他无关紧要的元素</span></span><br><span class="line">&lt;U&gt; <span class="function">U <span class="title">reduce</span><span class="params">(U identity,</span></span></span><br><span class="line"><span class="function"><span class="params">          BiFunction&lt;U, ? <span class="keyword">super</span> T, U&gt; accumulator,</span></span></span><br><span class="line"><span class="function"><span class="params">          BinaryOperator&lt;U&gt; combiner)</span></span>;</span><br><span class="line">｝</span><br></pre></td></tr></table></figure></li><li><p>顺序流&amp;并行流&amp;无序流之间的切换操作</p><p>在使用并行流时，有时候流是无序的就能获得性能上的提升，可以通过BaseStream接口提供的unordered()方法把流转换成一个无序流之后，再进行各种操作</p><p>forEach()方法不一定会保留并行流的顺序，如果在对并行流的每个元素执行操作时，也希望保留顺序，那么可以使用forEachOrdered()方法，它的用法和forEach()是一样的。</p><p>forEach底层采用的是迭代器的方式。如果数据结构是ArrayList这种数据结构，那你可以采用for,但是你的数据结构如果是LinkList那你千万别再用for,应该果断采用forEach,因为数据一多起来的，for此时的效率低得可怜</p></li><li><p>映射</p><ul><li><p>filter方法</p><p>filter方法的参数是一个Predicate<t>对象，即一个从T到boolean的函数，返回为true的</t></p></li><li><p>map方法</p><p>对一个流中的值进行某种形式的转换，返回的是对应类型的Stream对象。</p></li><li><p>flatMap方法</p><p>flat – 摊平，流的扁平化</p><p>flatMap()操作能把原始流中的元素进行一对多的转换，并且将新生成的元素全都合并到它返回的流里面，即重新整合为一个流。</p><p>将多个Stream连接成一个Stream，这时候不是用新值取代Stream的值，与map有所区别，这是重新生成一个Stream对象取而代之。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String[] words = <span class="keyword">new</span> String[]&#123;<span class="string">"Hello"</span>,<span class="string">"World"</span>&#125;;</span><br><span class="line">List&lt;String&gt; a = Arrays.stream(words)</span><br><span class="line">    .map(word -&gt; word.split(<span class="string">""</span>))</span><br><span class="line">    .flatMap(Arrays::stream)</span><br><span class="line">    .distinct()</span><br><span class="line">    .collect(toList());</span><br><span class="line">a.forEach(System.out::print);</span><br><span class="line"><span class="comment">// 输出 ["H","e","l","o","W","r","d"]</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p>收集功能</p><ul><li><p><code>Collectors</code>类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt;  Collector&lt;T, ?, List&lt;T&gt;&gt; toList()</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Collector&lt;T, ?, Set&lt;T&gt;&gt; toSet()</span><br></pre></td></tr></table></figure><p>用法：<code>steam.collect(Collectors.toList)</code></p></li><li><p>collect方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;R&gt; <span class="function">R <span class="title">collect</span><span class="params">(Supplier&lt;R&gt; supplier,</span></span></span><br><span class="line"><span class="function"><span class="params">                 BiConsumer&lt;R, ? <span class="keyword">super</span> T&gt; accumulator,</span></span></span><br><span class="line"><span class="function"><span class="params">                 BiConsumer&lt;R, R&gt; combiner)</span></span>;</span><br></pre></td></tr></table></figure><p>类似上面的缩减操作。其中supplier指定如何创建用于保存结果的对象，比如，要使用ArrayList作为结果的集合，需要指定它的构造函数，accumulator函数是将一个元素添加到结果中，而combiner函数合并两个部分的结果</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">learnCollect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;HeroPlayerGold&gt; lists = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        lists.add(<span class="keyword">new</span> HeroPlayerGold(<span class="string">"盖伦"</span>, <span class="string">"RNG-Letme"</span>, <span class="number">100</span>));</span><br><span class="line">        lists.add(<span class="keyword">new</span> HeroPlayerGold(<span class="string">"诸葛亮"</span>, <span class="string">"RNG-Xiaohu"</span>, <span class="number">300</span>));</span><br><span class="line">        lists.add(<span class="keyword">new</span> HeroPlayerGold(<span class="string">"露娜"</span>, <span class="string">"RNG-MLXG"</span>, <span class="number">300</span>));</span><br><span class="line">        lists.add(<span class="keyword">new</span> HeroPlayerGold(<span class="string">"狄仁杰"</span>, <span class="string">"RNG-UZI"</span>, <span class="number">500</span>));</span><br><span class="line">        lists.add(<span class="keyword">new</span> HeroPlayerGold(<span class="string">"牛头"</span>, <span class="string">"RNG-Ming"</span>, <span class="number">500</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        lists.stream().collect(HashSet::<span class="keyword">new</span>,</span><br><span class="line">                               HashSet::add,</span><br><span class="line">                               HashSet::addAll</span><br><span class="line">        ).forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><h4 id="Spliterator"><a href="#Spliterator" class="headerlink" title="Spliterator"></a>Spliterator</h4><p>Spliterator是Java8新增的一种迭代器，Spliterator支持并行迭代。</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;java8新特性：函数式编程，stream流，&lt;em&gt;Optional&lt;/em&gt;  类！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="java8" scheme="https://JarvanKuo.github.io/categories/java/java8/"/>
    
    
      <category term="java8" scheme="https://JarvanKuo.github.io/tags/java8/"/>
    
      <category term="函数式编程" scheme="https://JarvanKuo.github.io/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>atlas笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/atlas%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/atlas笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:51:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>atlas：mysql-proxy扩展，mysql中间件，可以实现分表、分库（sharding版本）、读写分离、数据库连接池等功能！</p><a id="more"></a><p>Atlas类似于Twemproxy，是Qihoo 360基于Mysql Proxy开发的一个Mysql中间件，据称每天承载读写请求数达几十亿，可以实现分表、分库（sharding版本）、读写分离、数据库连接池等功能，缺点是没有实现跨库分表功能，需要在客户端使用分库逻辑，目前Atlas不活跃</p><p>参考文献：</p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>win10 下 wsl 环境 ubuntu 的 atlas</p><h2 id="Mysql-Atlas配置"><a href="#Mysql-Atlas配置" class="headerlink" title="Mysql+Atlas配置"></a>Mysql+Atlas配置</h2><ol><li><p>ubuntu 下安装 Atlas</p><p>源码安装方式：请参考<a href="https://www.iteye.com/blog/jinnianshilongnian-2188113" target="_blank" rel="noopener">第六章 Web开发实战1——HTTP服务</a></p><p> 源码编译方法不行的话，直接下载DEB包后用dpkg -i安装即可，<em>注意：</em>旧版本才有<a href="https://github.com/Qihoo360/Atlas/releases/download/2.2/Atlas-2.2-debian7.0-x86_64.deb" target="_blank" rel="noopener">DEB包</a></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/Qihoo360/Atlas/releases/download/2.2/Atlas-2.2-debian7.0-x86_64.deb</span><br><span class="line">dpkg -i Atlas-2.2-debian7.0-x86_64.deb</span><br></pre></td></tr></table></figure></li><li><p>ubuntu 下启动 Atlas 缺失 libmysqlclient.so.18</p><p>参考：<a href="https://blog.csdn.net/ling811/article/details/75258553" target="_blank" rel="noopener">启动zabbix报缺少libmysqlclient.so.18</a>，请自行下载：</p> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先查找一下</span></span><br><span class="line">whereis libmysqlclient.so.18</span><br><span class="line"><span class="comment"># 如果存在则软连接到库路径</span></span><br><span class="line">$ ln -s /usr/<span class="built_in">local</span>/mysql/lib/libmysqlclient.so.18 /usr/lib64/libmysqlclient.so.18</span><br><span class="line"><span class="comment"># 没有则下载后链接</span></span><br><span class="line">wget -O /usr/lib/libmysqlclient.so.18 http://files.directadmin.com/services/es_7.0_64/libmysqlclient.so.18</span><br></pre></td></tr></table></figure></li><li><p>atlas配置</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/<span class="built_in">local</span>/mysql-proxy/conf/chapter6.cnf</span><br></pre></td></tr></table></figure></li><li><p>Atlas启动/重启/停止</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chapter6 即上述的 chapter6.cnf</span></span><br><span class="line">/usr/<span class="built_in">local</span>/mysql-proxy/bin/mysql-proxyd chapter6 &#123; start | restart | stop &#125;</span><br></pre></td></tr></table></figure></li><li><p>atlas管理</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -h127.0.0.1 -P1113  -uadmin -p123456  </span><br><span class="line">SELECT * FROM <span class="built_in">help</span>  <span class="comment"># 查看帮助</span></span><br></pre></td></tr></table></figure></li><li><p>atlas 客户端</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过代理端口进入客户端</span></span><br><span class="line">mysql -h127.0.0.1 -P1112  -uroot -p123456</span><br><span class="line">use chapter6;  </span><br><span class="line">insert into ad values(1 <span class="string">'测试1);      </span></span><br><span class="line"><span class="string">insert into ad values(2, '</span>测试2<span class="string">');      </span></span><br><span class="line"><span class="string">insert into ad values(3 '</span>测试3);      </span><br><span class="line">select * from ad <span class="built_in">where</span> sku_id=1;  </span><br><span class="line">select * from ad <span class="built_in">where</span> sku_id=2;  </span><br><span class="line"><span class="comment">#通过如下sql可以看到实际的分表结果  </span></span><br><span class="line">select * from ad_0;  </span><br><span class="line">select * from ad_1;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;atlas：mysql-proxy扩展，mysql中间件，可以实现分表、分库（sharding版本）、读写分离、数据库连接池等功能！&lt;/p&gt;
    
    </summary>
    
    
      <category term="数据库" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="mysql" scheme="https://JarvanKuo.github.io/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/"/>
    
    
      <category term="atlas" scheme="https://JarvanKuo.github.io/tags/atlas/"/>
    
  </entry>
  
  <entry>
    <title>API接口安全处理</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/API%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8%E5%A4%84%E7%90%86/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/API接口安全处理/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:48:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>开放API接口安全处理！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.cnblogs.com/shenkebky/p/8461841.html" target="_blank" rel="noopener">公钥，私钥和数字签名这样最好理解 (转载)</a></p><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>存在问题：</p><ul><li>数据窃取</li><li>数据篡改</li><li>数据泄露</li></ul><p>对应解决方法：</p><ul><li>加密：RSA/DES</li><li>混淆算法：MD5</li><li>令牌：TOKEN</li></ul><h2 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h2><ul><li><p>对称</p><p>DES</p><p>AES</p></li><li><p>非对称（公私钥）</p><p>RSA</p><p>作用：</p><pre><code>- 加密：公钥加密-&gt;私钥解密- 签名：私钥加密-&gt;公钥解密（私钥数字签名，公钥验证身份）</code></pre></li></ul><h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><ul><li><p>Message Digest Algorithm </p><p>MD5（中文名为消息摘要算法第五版）为计算机安全领域广泛使用的一种散列函数，用以提供消息的完整性保护。</p></li><li><p>MD5算法特点：</p></li></ul><ol><li><p>压缩性：任意长度的数据，算出的MD5值长度都是固定的。</p></li><li><p>容易计算：从原数据计算出MD5值很容易。</p></li><li><p>抗修改性：对原数据进行任何改动，哪怕只修改1个字节，所得到的MD5值都有很大区别。</p></li><li><p>强抗碰撞：已知原数据和其MD5值，想找到一个具有相同MD5值的数据（即伪造数据）是非常困难的。</p></li></ol><ul><li><p>原理上不能破解，不可逆算法</p><p>但是有些数字可以由彩虹表（数据非常庞大）的碰撞来获取</p></li><li><p>MD5加盐</p><p>MD5(“”+””+salt)</p></li><li><p>应用场景</p><ol><li>接口规定根据那些字段生成MD5</li><li>接口获取第三方调用者的参数来生成对应的MD5和传入的MD5比较</li><li>可以校验表单数据的完整性，防篡改</li></ol></li></ul><h2 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h2><p>通常在登录时获取，判断用户是否登录状态</p><h2 id="开放api参数"><a href="#开放api参数" class="headerlink" title="开放api参数"></a>开放api参数</h2><ul><li><p>id主键不要设置成自增序列</p><p>自增序列会容易给轮询，爬虫</p></li></ul><h2 id="重复提交，恶意调用"><a href="#重复提交，恶意调用" class="headerlink" title="重复提交，恶意调用"></a>重复提交，恶意调用</h2><p>场景：交易类，订单类，有效期，幂等性</p><ul><li>返回服务器时间戳参数，调用时传入，与当前服务器时间比较，有效期内才通过</li><li>随机数</li></ul><h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><h2 id="验证码"><a href="#验证码" class="headerlink" title="验证码"></a>验证码</h2><p>短信类：图形验证码</p><p>注册下发短信：没有用户信息，无法从业务上限制，只能弄人机交互的验证码</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;开放API接口安全处理！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="接口规范" scheme="https://JarvanKuo.github.io/categories/java/%E6%8E%A5%E5%8F%A3%E8%A7%84%E8%8C%83/"/>
    
    
      <category term="加解密" scheme="https://JarvanKuo.github.io/tags/%E5%8A%A0%E8%A7%A3%E5%AF%86/"/>
    
      <category term="安全" scheme="https://JarvanKuo.github.io/tags/%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>openresty安装笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/openresty%E5%AE%89%E8%A3%85%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/openresty安装笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:56:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>openresty安装在ubuntu下的安装</p><a id="more"></a><p>参考 <a href="https://www.iteye.com/blog/jinnianshilongnian-2186270" target="_blank" rel="noopener">安装OpenResty(Nginx+Lua)开发环境</a></p><h2 id="安装步骤："><a href="#安装步骤：" class="headerlink" title="安装步骤："></a>安装步骤：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建目录/usr/servers，以后我们把所有软件安装在此目录</span></span><br><span class="line">mkdir -p /usr/servers  </span><br><span class="line"><span class="built_in">cd</span> /usr/servers/  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">apt-get install libreadline-dev libncurses5-dev libpcre3-dev libssl-dev perl </span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载ngx_openresty-1.7.7.2.tar.gz并解压</span></span><br><span class="line">wget http://openresty.org/download/ngx_openresty-1.7.7.2.tar.gz  </span><br><span class="line">tar -xzvf ngx_openresty-1.7.7.2.tar.gz  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装LuaJIT</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2/bundle/LuaJIT-2.1-20150120/  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 没有安装make的需要先安装</span></span><br><span class="line">    apt install make</span><br><span class="line">    apt install make-guile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 没安装gcc的需要先执行以下命令</span></span><br><span class="line">sudo apt-get  build-dep  gcc </span><br><span class="line"></span><br><span class="line">make clean &amp;&amp; make &amp;&amp; make install  </span><br><span class="line">ln -sf luajit-2.1.0-alpha /usr/<span class="built_in">local</span>/bin/luajit  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载ngx_cache_purge模块，该模块用于清理nginx缓存</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2/bundle  </span><br><span class="line">wget https://github.com/FRiCKLE/ngx_cache_purge/archive/2.3.tar.gz  </span><br><span class="line">tar -xvf 2.3.tar.gz  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 下载nginx_upstream_check_module模块，该模块用于ustream健康检查</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2/bundle  </span><br><span class="line">wget https://github.com/yaoweibin/nginx_upstream_check_module/archive/v0.3.0.tar.gz  </span><br><span class="line">tar -xvf v0.3.0.tar.gz   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装ngx_openresty</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2  </span><br><span class="line">./configure --prefix=/usr/servers --with-http_realip_module  --with-pcre  --with-luajit --add-module=./bundle/ngx_cache_purge-2.3/ --add-module=./bundle/nginx_upstream_check_module-0.3.0/ -j2  </span><br><span class="line"><span class="comment"># 报错 checking for zlib library ... not found，需要安装 zlib</span></span><br><span class="line">sudo apt-get install zlib1g-dev</span><br><span class="line">make &amp;&amp; make install  </span><br><span class="line"><span class="comment"># 报错 recipe for target 'objs/src/event/ngx_event_openssl.o' failed，openssl版本问题，需要安装旧版本</span></span><br><span class="line"><span class="comment"># 需要指定旧版本，推荐在编译 Nginx 时指定 OpenSSL 源码目录，而不是使用系统自带的版本，这样更可控</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2/bundle </span><br><span class="line">wget -O openssl.tar.gz -c https://github.com/openssl/openssl/archive/OpenSSL_1_0_2k.tar.gz</span><br><span class="line">tar zxf openssl.tar.gz</span><br><span class="line">mv openssl-OpenSSL_1_0_2k/ openssl</span><br><span class="line"><span class="comment"># 重新配置 ngx_openresty</span></span><br><span class="line"><span class="built_in">cd</span> /usr/servers/ngx_openresty-1.7.7.2</span><br><span class="line">./configure \</span><br><span class="line">--prefix=/usr/servers \</span><br><span class="line">--with-http_realip_module  \</span><br><span class="line">--with-pcre  \</span><br><span class="line">--with-luajit \</span><br><span class="line">--add-module=./bundle/ngx_cache_purge-2.3/ \</span><br><span class="line">--add-module=./bundle/nginx_upstream_check_module-0.3.0/ \</span><br><span class="line">--with-openssl=./bundle/openssl \</span><br><span class="line">-j2  </span><br><span class="line"><span class="comment"># 重新make</span></span><br><span class="line">make &amp;&amp; make install  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动nginx，访问 http://localhost/ 成功即可</span></span><br><span class="line">/usr/servers/nginx/sbin/nginx</span><br></pre></td></tr></table></figure><p><em>拓展：</em></p><ol><li><a href="https://blog.csdn.net/qq_35865125/article/details/80519030" target="_blank" rel="noopener">ubuntu gcc 安装 使用</a></li><li><a href="https://blog.csdn.net/wsclinux/article/details/50494501" target="_blank" rel="noopener">ubantu下安装zlib的方法</a></li><li><a href="https://imququ.com/post/my-nginx-conf.html" target="_blank" rel="noopener">Nginx 配置之完整篇</a></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;openresty安装在ubuntu下的安装&lt;/p&gt;
    
    </summary>
    
    
      <category term="服务器" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="nginx" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/nginx/"/>
    
    
      <category term="openresty" scheme="https://JarvanKuo.github.io/tags/openresty/"/>
    
  </entry>
  
  <entry>
    <title>linux笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/linux%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/linux笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-26T13:51:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>linux相关命令、配置。</p><a id="more"></a><p>参考文献：</p><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><ul><li><p><a href="https://blog.csdn.net/weixin_42425141/article/details/80940069" target="_blank" rel="noopener">字符编码转换 iconv命令</a></p><p><strong>iconv命令</strong>是用来转换文件的编码方式的</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法</span></span><br><span class="line">iconv -f encoding [-t encoding] [inputfile]... </span><br><span class="line"><span class="comment"># 选项</span></span><br><span class="line">-f encoding :把字符从encoding编码开始转换。 </span><br><span class="line">-t encoding :把字符转换到encoding编码。 </span><br><span class="line">-l :列出已知的编码字符集合 </span><br><span class="line">-o file :指定输出文件 </span><br><span class="line">-c :忽略输出的非法字符 </span><br><span class="line">-s :禁止警告信息，但不是错误信息 </span><br><span class="line">--verbose :显示进度信息 </span><br><span class="line">-f和-t所能指定的合法字符在-l选项的命令里面都列出来了。 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出当前支持的字符编码： </span></span><br><span class="line">iconv -l </span><br><span class="line"><span class="comment"># 将文件file1转码，转后文件输出到fil2中： </span></span><br><span class="line">iconv file1 -f EUC-JP-MS -t UTF-8 -o file2</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;linux相关命令、配置。&lt;/p&gt;
    
    </summary>
    
    
      <category term="linux" scheme="https://JarvanKuo.github.io/categories/linux/"/>
    
    
      <category term="linux" scheme="https://JarvanKuo.github.io/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>markdown笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/markdown%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/markdown笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:52:20.000Z</updated>
    
    <content type="html"><![CDATA[<p>markdown总结！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.jianshu.com/p/b0f56b7d7ee8" target="_blank" rel="noopener">Markdown创建表格</a></p><h2 id="markdown创建表格"><a href="#markdown创建表格" class="headerlink" title="markdown创建表格"></a>markdown创建表格</h2><ul><li>极简方式</li></ul><table><thead><tr><th>name</th><th>价格</th><th>数量</th></tr></thead><tbody><tr><td>香蕉</td><td>$1</td><td>5</td></tr><tr><td>苹果</td><td>$1</td><td>6</td></tr><tr><td>草莓</td><td>$1</td><td>7</td></tr></tbody></table><ul><li>格式化</li></ul><table><thead><tr><th align="center">name</th><th align="center">111</th><th align="center">222</th><th align="center">333</th><th align="center">444</th></tr></thead><tbody><tr><td align="center">aaa</td><td align="center">bbb</td><td align="center">ccc</td><td align="center">ddd</td><td align="center">eee</td></tr><tr><td align="center">fff</td><td align="center">ggg</td><td align="center">hhh</td><td align="center">iii</td><td align="center">000</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;markdown总结！&lt;/p&gt;
    
    </summary>
    
    
      <category term="编辑器" scheme="https://JarvanKuo.github.io/categories/%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
      <category term="markdown" scheme="https://JarvanKuo.github.io/categories/%E7%BC%96%E8%BE%91%E5%99%A8/markdown/"/>
    
    
      <category term="markdown" scheme="https://JarvanKuo.github.io/tags/markdown/"/>
    
  </entry>
  
  <entry>
    <title>nginx配置</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/nginx%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/nginx笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:53:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>nginx的命令，配置！</p><a id="more"></a><h2 id="nginx工作原理"><a href="#nginx工作原理" class="headerlink" title="nginx工作原理"></a>nginx工作原理</h2><p><a href="https://blog.csdn.net/kim_weir/article/details/80036462" target="_blank" rel="noopener">Nginx工作原理（Master+Worker）</a></p><h2 id="nginx常用命令"><a href="#nginx常用命令" class="headerlink" title="nginx常用命令"></a>nginx常用命令</h2><ol><li><p>测试配置文件</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx  -t</span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>启动：</p><p> 指定配置文件</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -p `<span class="built_in">pwd</span>`/ -c conf/nginx.conf</span><br></pre></td></tr></table></figure></li><li><p>停止：</p><p> nginx指定配置文件的，停止时也需指定参数</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -p `<span class="built_in">pwd</span>`/ -c conf/nginx.conf -s quit</span><br></pre></td></tr></table></figure></li></ol><h2 id="nginx概念"><a href="#nginx概念" class="headerlink" title="nginx概念"></a>nginx概念</h2><ul><li><p>upstream 负载均衡概要</p><p>upstream 是 Nginx 的 HTTP Upstream 模块，这个模块通过一个简单的调度算法来实现客户<br>端 IP 到后端服务器的负载均衡</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">upstream</span> test.net&#123;</span><br><span class="line">    ip_hash;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.10.13:80</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.10.14:80</span> down;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.10.15:8009</span> max_fails=<span class="number">3</span> fail_timeout=<span class="number">20s</span>;</span><br><span class="line">    <span class="attribute">server</span> <span class="number">192.168.10.16:8080</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">proxy_pass</span> http://test.net;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;nginx的命令，配置！&lt;/p&gt;
    
    </summary>
    
    
      <category term="服务器" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="nginx" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/nginx/"/>
    
    
      <category term="nginx" scheme="https://JarvanKuo.github.io/tags/nginx/"/>
    
  </entry>
  
  <entry>
    <title>ForkJoin框架</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/ForkJoin%E6%A1%86%E6%9E%B6/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/ForkJoin框架/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T12:19:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>ForkJoin框架概要！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.cnblogs.com/wzqjy/p/7921063.html" target="_blank" rel="noopener">Java–8–新特性–串并行流与ForkJoin框架</a></p><h2 id="ForkJoin框架概念"><a href="#ForkJoin框架概念" class="headerlink" title="ForkJoin框架概念"></a>ForkJoin框架概念</h2><p>Fork/Join框架：在必要的情况下，将一个大任务，进行拆分（fork） 成若干个子任务（拆到不能再拆，这里就是指我们制定的拆分的临界值），再将一个个小任务的结果进行join汇总。</p><h2 id="Fork-Join与传统线程池的区别"><a href="#Fork-Join与传统线程池的区别" class="headerlink" title="Fork/Join与传统线程池的区别"></a>Fork/Join与传统线程池的区别</h2><p>Fork/Join采用“工作窃取模式”，当执行新的任务时他可以将其拆分成更小的任务执行，并将小任务加到线程队列中，然后再从一个随即线程中偷一个并把它加入自己的队列中。</p><h2 id="Java8-Stream-API"><a href="#Java8-Stream-API" class="headerlink" title="Java8 Stream API"></a>Java8 Stream API</h2><p>Stream并行流底层Fork/Join实现，使用Stream并行流更简洁。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">long</span> count = Arrays.asList(bag).parallelStream().filter(balance::weight).count();</span><br></pre></td></tr></table></figure><p>参考：</p><p>请移步 <a href="/2019/09/17/java8新特性/" title="java8新特性">java8新特性</a></p><p><a href="https://www.cnblogs.com/ITyunbook/p/10892472.html" target="_blank" rel="noopener">Fork/Join框架与Java8 Stream API 之并行流的速度比较</a></p><p><a href="https://www.jianshu.com/p/ac2bcf2f9d48" target="_blank" rel="noopener">Java8之Stream流（四）并行流</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ForkJoin框架概要！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="分布式" scheme="https://JarvanKuo.github.io/categories/java/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    
      <category term="ForkJoin" scheme="https://JarvanKuo.github.io/tags/ForkJoin/"/>
    
  </entry>
  
  <entry>
    <title>openresty配置</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/openresty%E9%85%8D%E7%BD%AE/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/openresty配置/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:53:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>openresty配置的一些问题总结！</p><a id="more"></a><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><ul><li><p>win10下的linux子系统ubuntu（wsl）</p></li><li><p>openresty版本：ngx_openresty-1.7.7.2.tar.gz</p></li></ul><h2 id="wsl安装"><a href="#wsl安装" class="headerlink" title="wsl安装"></a>wsl安装</h2><p>请移步 <a href="/2019/09/17/wsl笔记/" title="wsl笔记">wsl笔记</a></p><h2 id="openresty安装"><a href="#openresty安装" class="headerlink" title="openresty安装"></a>openresty安装</h2><p>请参考<a href="https://www.iteye.com/blog/jinnianshilongnian-2186270" target="_blank" rel="noopener">安装OpenResty(Nginx+Lua)开发环境</a></p><p>或者参考  <a href="/2019/09/17/openresty安装笔记/" title="openresty安装笔记">openresty安装笔记</a></p><h3 id="openssl版本问题"><a href="#openssl版本问题" class="headerlink" title="openssl版本问题"></a>openssl版本问题</h3><p>需要指定旧版本，推荐在编译 Nginx 时指定 OpenSSL 源码目录，而不是使用系统自带的版本，这样更可控。</p><p>参考<a href="https://imququ.com/post/my-nginx-conf.html" target="_blank" rel="noopener">openssl版本问题</a></p><h3 id="Lua模块安装"><a href="#Lua模块安装" class="headerlink" title="Lua模块安装"></a>Lua模块安装</h3><ol><li><p>安装 LuaRocks </p><p> LuaRocks: Lua 的模块安装和部署工具</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install luarocks</span><br></pre></td></tr></table></figure></li><li><p>安装 luasocket</p><p> lua 远程调试引入的 <code>require(&quot;mobdebug&quot;).start()</code> 需要 socket </p><p> <em>注</em>：Lua 的 Remote Debug 远程调试 现在还搞不定，此处占个坑。</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">luarocks install luasocket</span><br></pre></td></tr></table></figure></li></ol><h2 id="openresty使用"><a href="#openresty使用" class="headerlink" title="openresty使用"></a>openresty使用</h2><h3 id="nginx常用命令"><a href="#nginx常用命令" class="headerlink" title="nginx常用命令"></a>nginx常用命令</h3><ol><li><p>启动：</p><p> 指定配置文件</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -p `<span class="built_in">pwd</span>`/ -c conf/nginx.conf</span><br></pre></td></tr></table></figure></li><li><p>停止：</p><p> nginx指定配置文件的，停止时也需指定参数</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -p `<span class="built_in">pwd</span>`/ -c conf/nginx.conf -s quit</span><br></pre></td></tr></table></figure></li></ol><h3 id="nginx-conf-配置"><a href="#nginx-conf-配置" class="headerlink" title="nginx.conf 配置"></a>nginx.conf 配置</h3><ul><li><p>正则匹配路径</p><table><thead><tr><th align="left">模式</th><th align="left">含义</th></tr></thead><tbody><tr><td align="left">location = /uri</td><td align="left">= 表示精确匹配，只有完全匹配上才能生效</td></tr><tr><td align="left">location ^~ /uri</td><td align="left">^~ 开头对URL路径进行前缀匹配，并且在正则之前。</td></tr><tr><td align="left">location ~ pattern</td><td align="left">开头表示区分大小写的正则匹配</td></tr><tr><td align="left">location ~* pattern</td><td align="left">开头表示不区分大小写的正则匹配</td></tr><tr><td align="left">location /uri</td><td align="left">不带任何修饰符，也表示前缀匹配，但是在正则匹配之后</td></tr><tr><td align="left">location /</td><td align="left">通用匹配，任何未匹配到其它location的请求都会匹配到，相当于switch中的default</td></tr></tbody></table><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> <span class="regexp">~ ^/api/([-_a-zA-Z0-9]+)</span> &#123;</span><br><span class="line">    <span class="comment"># 准入阶段完成参数验证</span></span><br><span class="line">    <span class="attribute">access_by_lua_file</span>  nginx_test_server/access_check.lua;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#内容生成阶段</span></span><br><span class="line">    <span class="attribute">content_by_lua_file</span> nginx_test_server/<span class="variable">$1</span>.lua;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>开发调试时取消缓存</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这里设置为 off，是为了避免每次修改之后都要重新 reload 的麻烦。</span></span><br><span class="line"><span class="comment"># 在生产环境上务必确保 lua_code_cache 设置成 on。</span></span><br><span class="line"><span class="attribute">lua_code_cache</span> <span class="literal">off</span>;</span><br></pre></td></tr></table></figure></li><li><p>http 模块 报错 bad argument #2 to ‘set_keepalive’ (number expected, got nil)</p><p>  参考：<a href="https://blog.csdn.net/miachen520/article/details/91353525" target="_blank" rel="noopener">bad argument #2 to ‘set_keepalive’ (number expected, got nil)的解决办法</a></p><p>  在关联数组中多传一个参数keepalive=false 即</p>  <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">method = “GET”,</span><br><span class="line"><span class="built_in">path</span> = requestBody,</span><br><span class="line">keepalive=<span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="lua-的一些坑"><a href="#lua-的一些坑" class="headerlink" title="lua 的一些坑"></a>lua 的一些坑</h2><ul><li><p>openresty/lua-resty-redis 的 批量查询 返回值问题</p><p>参考：<a href="https://blog.csdn.net/scdxmoe/article/details/52171720" target="_blank" rel="noopener">nil、null与ngx.null</a></p><p><a href="https://github.com/openresty/lua-resty-redis/blob/master/README.markdown" target="_blank" rel="noopener">官方说明</a></p><p>A non-nil Redis “bulk reply” results in a Lua string as the return value. A nil bulk reply results in a <code>ngx.null</code> return value.</p><p>A nil multi-bulk reply returns in a <code>ngx.null</code> value.</p><p>如果使用批量查询如mget，查不到数据会返回 ngx.null     </p></li></ul><h2 id="OpenResty缓存"><a href="#OpenResty缓存" class="headerlink" title="OpenResty缓存"></a>OpenResty缓存</h2><p>需要先在 nginx.conf 里面的修改 ，这个 cache 是 Nginx 所有 worker 之间共享的</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">lua_shared_dict</span> my_cache <span class="number">128m</span>;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;openresty配置的一些问题总结！&lt;/p&gt;
    
    </summary>
    
    
      <category term="服务器" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
      <category term="nginx" scheme="https://JarvanKuo.github.io/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/nginx/"/>
    
    
      <category term="openresty" scheme="https://JarvanKuo.github.io/tags/openresty/"/>
    
  </entry>
  
  <entry>
    <title>template</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/template/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/template/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T03:54:16.000Z</updated>
    
    <content type="html"><![CDATA[<p>这是文章模板！</p><a id="more"></a><p>参考文献：</p><p>## </p><p>## </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是文章模板！&lt;/p&gt;
    
    </summary>
    
    
      <category term="template" scheme="https://JarvanKuo.github.io/categories/template/"/>
    
      <category term="template" scheme="https://JarvanKuo.github.io/categories/template/template/"/>
    
    
      <category term="template" scheme="https://JarvanKuo.github.io/tags/template/"/>
    
  </entry>
  
  <entry>
    <title>spring笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/spring%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/spring笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:57:10.000Z</updated>
    
    <content type="html"><![CDATA[<p>spring的一些坑！</p><a id="more"></a><p>参考文献：</p><h2 id="spring容器"><a href="#spring容器" class="headerlink" title="spring容器"></a>spring容器</h2><ul><li><p>Spring中自己new出来的对象不能自动注入对象和属性</p><ul><li><p>原因</p><p> @Autowired注入时是将类交给Springboot管理，而new出来的实例脱离了Springboot的管理，两个东西不在一个管理者管理下，所以没法联系在一起，@Autowired注入就会为null。</p></li><li><p>解决方法</p><ol><li><p>不要用new的方式实例化，也采用注解的方式，在需要new的实例类上加@Component注解，通过注入的方式使用实例化类。</p></li><li><p>使用ApplicationContextAware和反射方式获取容器的bean重新set进去</p><p>参考：<a href="https://blog.csdn.net/cgengwei/article/details/79419305" target="_blank" rel="noopener">自己new的对象怎么注入spring管理的对象</a></p></li></ol></li></ul></li></ul><p>## </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;spring的一些坑！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="spring" scheme="https://JarvanKuo.github.io/categories/java/spring/"/>
    
    
      <category term="spring" scheme="https://JarvanKuo.github.io/tags/spring/"/>
    
  </entry>
  
  <entry>
    <title>wsl笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/wsl%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/wsl笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:59:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>wsl 下的 ubuntu 系统一些问题总结！</p><a id="more"></a><p>参考文献：</p><p><a href="https://iyaozhen.com/windows10-wsl-ubuntu.html" target="_blank" rel="noopener">Windows 10生产力提升之WSL实践</a></p><p><a href="https://hbaaron.github.io/blog_2017/%E5%9C%A8wsl%E4%B8%8B%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8sshd%E5%85%A8%E6%94%BB%E7%95%A5/" target="_blank" rel="noopener">在wsl下安装使用sshd全攻略.md</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>win10 下 wsl 环境安装 ubuntu</p><h2 id="修改更新源"><a href="#修改更新源" class="headerlink" title="修改更新源"></a>修改更新源</h2><ol><li><p>备份文件</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list  /etc/apt/sources.list.old</span><br></pre></td></tr></table></figure></li><li><p>使用阿里源</p><p> 打开文件：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> sudo vi /etc/apt/sources.list</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p> 整个文件替换成阿里源：</p> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse</span></span><br><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse</span></span><br><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse</span></span><br><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse</span></span><br><span class="line">deb http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span></span><br><span class="line">deb-src http:<span class="comment">//mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse</span></span><br></pre></td></tr></table></figure></li><li><p>更新</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure></li></ol><h2 id="设置超级用户"><a href="#设置超级用户" class="headerlink" title="设置超级用户"></a>设置超级用户</h2><p>ubuntu的su初始密码设置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd</span><br></pre></td></tr></table></figure><h2 id="zsh美化终端"><a href="#zsh美化终端" class="headerlink" title="zsh美化终端"></a>zsh美化终端</h2><p><a href="https://www.jianshu.com/p/723c2241e8e7" target="_blank" rel="noopener">安装使用oh-my-zsh（Win10+WSL或Ubuntu）</a></p><h3 id="设zsh为默认shell"><a href="#设zsh为默认shell" class="headerlink" title="设zsh为默认shell"></a>设zsh为默认shell</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /bin/zsh <span class="comment"># 设置 bash 同理</span></span><br></pre></td></tr></table></figure><h3 id="环境变量PATH"><a href="#环境变量PATH" class="headerlink" title="环境变量PATH"></a>环境变量PATH</h3><p>使用zsh后，环境变量需要在 ~/.zshrc 配置文件中定义，/etc/profile 是不会生效的</p><h2 id="开启-ssh-远程连接"><a href="#开启-ssh-远程连接" class="headerlink" title="开启 ssh 远程连接"></a>开启 ssh 远程连接</h2><p>wsl下的ubuntu自带ssh服务有问题需要卸载重装一遍ssh服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重装 openssh-server</span></span><br><span class="line">sudo apt-get remove openssh-server</span><br><span class="line">sudo apt-get install openssh-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 shd_config文件</span></span><br><span class="line">sudo vi /etc/ssh/sshd_config</span><br><span class="line"><span class="comment"># Port 22 #默认即可，如果有端口占用可以自己修改</span></span><br><span class="line"><span class="comment"># PasswordAuthentication yes # 允许用户名密码方式登录</span></span><br><span class="line"><span class="comment"># PermitRootLogin yes # 允许管理员ssh登录</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重启ssh服务</span></span><br><span class="line">sudo service ssh restart</span><br></pre></td></tr></table></figure><h2 id="apt命令与问题"><a href="#apt命令与问题" class="headerlink" title="apt命令与问题"></a>apt命令与问题</h2><p>[<a href="https://www.cnblogs.com/hk-faith/p/8776471.html" target="_blank" rel="noopener">Ubuntu的apt命令详解</a>]</p><ol><li>搜索软件</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo  apt-cache  search  package_name</span><br></pre></td></tr></table></figure><ol start="2"><li><p><a href="https://nowtime.cc/linux/683.html" target="_blank" rel="noopener">WSL Ubuntu 解决出现 E: Could not read response to hello message from hook …问题</a></p><p>执行以下命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo rm -rf /etc/apt/apt.conf.d/20snapd.conf</span><br></pre></td></tr></table></figure></li></ol><h2 id="windows-和-wsl-互相访问文件"><a href="#windows-和-wsl-互相访问文件" class="headerlink" title="windows 和 wsl 互相访问文件"></a>windows 和 wsl 互相访问文件</h2><ul><li><p>打开wsl文件</p><p>使用explorer.exe，wsl下切换用户就不能使用这个命令。。。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explorer.exe .</span><br></pre></td></tr></table></figure></li><li><p>访问windows文件，使用挂载方式/mnt/</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/c/Users/Ben/Documents/</span><br></pre></td></tr></table></figure></li></ul><h2 id="wsl开机没有自启动ssh"><a href="#wsl开机没有自启动ssh" class="headerlink" title="wsl开机没有自启动ssh"></a>wsl开机没有自启动ssh</h2><p>需要在wsl中手动运行一下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service ssh start</span><br></pre></td></tr></table></figure><p>由于是wsl内部是类似docker运行的，没有 systemd 服务</p><h2 id="重装python"><a href="#重装python" class="headerlink" title="重装python"></a>重装python</h2><ol><li><p>检查python路径：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方式一：</span></span><br><span class="line"><span class="built_in">type</span> -a python</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二：</span></span><br><span class="line">ls -l /usr/bin/python</span><br><span class="line">ls -l /usr/bin/python*</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式三：</span></span><br><span class="line"><span class="built_in">which</span> python</span><br></pre></td></tr></table></figure></li><li><p>安装python2、python3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装python2</span></span><br><span class="line">$ sudo apt-get install python</span><br><span class="line"><span class="comment"># 安装python3</span></span><br><span class="line">$ sudo apt-get install python3</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;wsl 下的 ubuntu 系统一些问题总结！&lt;/p&gt;
    
    </summary>
    
    
      <category term="linux" scheme="https://JarvanKuo.github.io/categories/linux/"/>
    
      <category term="ubuntu" scheme="https://JarvanKuo.github.io/categories/linux/ubuntu/"/>
    
    
      <category term="ubuntu" scheme="https://JarvanKuo.github.io/tags/ubuntu/"/>
    
  </entry>
  
  <entry>
    <title>Lombok插件</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/Lombok%E6%8F%92%E4%BB%B6/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/Lombok插件/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T03:46:28.000Z</updated>
    
    <content type="html"><![CDATA[<p>Lombok插件！</p><a id="more"></a><p>参考文献：</p><p><a href="https://blog.csdn.net/vbirdbest/article/details/79495398" target="_blank" rel="noopener">Lombok使用示例详情</a></p><h2 id="idea-使用-Lombok-plugin-插件"><a href="#idea-使用-Lombok-plugin-插件" class="headerlink" title="idea 使用 Lombok plugin 插件"></a>idea 使用 Lombok plugin 插件</h2><p>ntellij idea 使用Lombok需要安装插件：Lombok plugin: Preferences —&gt; Plugins —&gt; 搜索 Lombok plugin — &gt; Install<br>同时设置 Preferences -&gt; Compiler -&gt; Annotation Processors -&gt; Enable annotation processing勾选。</p><h2 id="maven-工程引入lombok依赖"><a href="#maven-工程引入lombok依赖" class="headerlink" title="maven 工程引入lombok依赖"></a>maven 工程引入lombok依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="常用注解"><a href="#常用注解" class="headerlink" title="常用注解"></a>常用注解</h2><ul><li><h3 id="Getter-Setter"><a href="#Getter-Setter" class="headerlink" title="@Getter/@Setter"></a>@Getter/@Setter</h3><ul><li><p>为字段生成Getter和Setter方法，可以注解到字段或者类上(注解在类上会为类中的所有字段生成Getter和Setter方法)，默认是public类型的，</p></li><li><p>如果需要的话可以修改方法的访问级别，<code>@Getter(AccessLevel.PROTECTED)</code></p></li></ul></li><li><h3 id="AllArgsConstructor"><a href="#AllArgsConstructor" class="headerlink" title="@AllArgsConstructor"></a>@AllArgsConstructor</h3><p>生成一个全参数的构造方法</p></li><li><h3 id="Data"><a href="#Data" class="headerlink" title="@Data"></a>@Data</h3><p>@Data 包含了 @ToString、@EqualsAndHashCode、@Getter / @Setter的功能</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Lombok插件！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="代码生成" scheme="https://JarvanKuo.github.io/categories/java/%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90/"/>
    
    
      <category term="Lombok" scheme="https://JarvanKuo.github.io/tags/Lombok/"/>
    
  </entry>
  
  <entry>
    <title>idea使用技巧</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/idea%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/idea使用技巧/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T06:51:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>idea使用技巧！</p><a id="more"></a><p>参考文献：</p><h2 id="技巧"><a href="#技巧" class="headerlink" title="技巧"></a>技巧</h2><ul><li><p>快捷键生成serialVersionUID</p><p><a href="https://blog.csdn.net/weixin_36910300/article/details/80176055" target="_blank" rel="noopener">IDEA快捷键生成serialVersionUID</a></p><ol><li>idea配置<code>serializable class without ‘serialVersionUID’</code></li><li>在对应类名上 alt+enter 即弹出对应选项</li></ol></li></ul><h2 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h2><ul><li><p>console中文乱码</p><ol><li><p>settings设置UTF-8</p></li><li><p>tomcat 设置 -Dfile.encoding=utf-8</p></li><li><p><strong><em>注意：</em></strong>IntelliJIDEA15.0.6\bin找到idea.exe.vmoption文件，这文件修改已经失效</p><p>替代方法：HELP-&gt;Edit Custom VM OPtions中加 -Dfile.encoding=utf-8</p></li></ol><p>​       升级后覆盖vmoption文件后会都需要手动设置一下，并重启idea</p><p>​       这个文件是在用户目录下的，而且命名不一定一致，所以直接在软件上操作</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;idea使用技巧！&lt;/p&gt;
    
    </summary>
    
    
      <category term="编辑器" scheme="https://JarvanKuo.github.io/categories/%E7%BC%96%E8%BE%91%E5%99%A8/"/>
    
      <category term="idea" scheme="https://JarvanKuo.github.io/categories/%E7%BC%96%E8%BE%91%E5%99%A8/idea/"/>
    
    
      <category term="idea" scheme="https://JarvanKuo.github.io/tags/idea/"/>
    
  </entry>
  
  <entry>
    <title>enum</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/enum%E7%94%A8%E6%B3%95/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/enum用法/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T04:10:26.000Z</updated>
    
    <content type="html"><![CDATA[<p>enum语法！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.cnblogs.com/liaojie970/p/6474733.html" target="_blank" rel="noopener">java enum的用法详解</a></p><p><a href="https://www.cnblogs.com/codething/p/9321174.html" target="_blank" rel="noopener">枚举ENUM的tostring() valueof()name()和values()用法</a></p><h2 id="Enum原理"><a href="#Enum原理" class="headerlink" title="Enum原理"></a>Enum原理</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> Size&#123; SMALL, MEDIUM, LARGE, EXTRA_LARGE &#125;;</span><br></pre></td></tr></table></figure><p><strong>实际上，这个声明定义的类型是一个类，它刚好有四个实例。</strong></p><h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><ul><li><p>枚举常用的方法是values():对枚举中的常量值进行遍历;</p></li><li><p>valueof(String name) :根据名称获取枚举类中定义的常量值;要求字符串跟枚举的常量名必须一致;</p></li><li><p>获取枚举类中的常量的名称使用枚举对象.name()</p></li><li><p>枚举类中重写了toString()方法,返回的是枚举常量的名称;</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;enum语法！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="语法" scheme="https://JarvanKuo.github.io/categories/java/%E8%AF%AD%E6%B3%95/"/>
    
    
      <category term="enum" scheme="https://JarvanKuo.github.io/tags/enum/"/>
    
  </entry>
  
  <entry>
    <title>maven笔记</title>
    <link href="https://JarvanKuo.github.io/2019/09/17/maven%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2019/09/17/maven笔记/</id>
    <published>2019-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T07:45:30.000Z</updated>
    
    <content type="html"><![CDATA[<p>maven笔记！</p><a id="more"></a><p>参考文献：</p><h2 id="指定编码和编译版本"><a href="#指定编码和编译版本" class="headerlink" title="指定编码和编译版本"></a>指定编码和编译版本</h2><p>pom.xml会覆盖idea的Project Structure设置的编译版本，需要在在pom.xml中指定</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># 或者</span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>## </p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;maven笔记！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="构建工具" scheme="https://JarvanKuo.github.io/categories/java/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="maven笔记" scheme="https://JarvanKuo.github.io/tags/maven%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>ant笔记</title>
    <link href="https://JarvanKuo.github.io/2018/09/17/ant%E7%AC%94%E8%AE%B0/"/>
    <id>https://JarvanKuo.github.io/2018/09/17/ant笔记/</id>
    <published>2018-09-17T05:50:09.000Z</published>
    <updated>2019-09-30T02:48:02.000Z</updated>
    
    <content type="html"><![CDATA[<p>ant的使用，命令！</p><a id="more"></a><p>参考文献：</p><p><a href="https://www.jianshu.com/p/cd47031d5771" target="_blank" rel="noopener">ant+maven一键打包springboot上传服务器发布</a></p><p><a href="https://blog.csdn.net/felix_cb/article/details/90643073" target="_blank" rel="noopener">判断linux文件、文件夹是否存在</a></p><p><a href="https://blog.csdn.net/sinat_36521655/article/details/79296181" target="_blank" rel="noopener">shell中脚本参数传递的两种方式</a></p><p><a href="http://smilejay.com/2011/08/unexpected-end-of-file/" target="_blank" rel="noopener">shell脚本“syntax error:unexpected end of file”解决方案</a></p><h2 id="ant远程部署"><a href="#ant远程部署" class="headerlink" title="ant远程部署"></a>ant远程部署</h2><ol><li><p>Ant 引用配置文件</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- set global properties for this build --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">file</span>=<span class="string">"build.properties"</span>/&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">&lt;!--输出配置信息--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">"show_property"</span> <span class="attr">description</span>=<span class="string">"show build.properties conf"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">echo</span>&gt;</span> ================== build.properties ================ <span class="tag">&lt;/<span class="name">echo</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">echo</span>&gt;</span>PROJECT_NAME=$&#123;ant.project.name&#125;<span class="tag">&lt;/<span class="name">echo</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">echo</span>&gt;</span>DEST_DIR=$&#123;DEST_DIR&#125;<span class="tag">&lt;/<span class="name">echo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><ol start="2"><li><p>target条件控制</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">"detect.file"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">condition</span> <span class="attr">property</span>=<span class="string">"fileIsExists"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">and</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">available</span> <span class="attr">file</span>=<span class="string">"c:/123.txt"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">and</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">condition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">target</span> <span class="attr">name</span>=<span class="string">"echoDemo"</span> <span class="attr">if</span>=<span class="string">"fileIsExists"</span> <span class="attr">depends</span>=<span class="string">"detect.file"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">echo</span> <span class="attr">message</span>=<span class="string">"hello ant"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><ol start="3"><li><p>Ant-sshexec-执行远程服务器或本地脚本</p><p> 需要先下载第三方依赖包jsch-0.1.46.jar到ant/lib目录</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sshexec</span> </span></span><br><span class="line"><span class="tag"><span class="attr">host</span>=<span class="string">"$&#123;host&#125;"</span></span></span><br><span class="line"><span class="tag"><span class="attr">username</span>=<span class="string">"$&#123;usr&#125;"</span>   </span></span><br><span class="line"><span class="tag"><span class="attr">password</span>=<span class="string">"$&#123;pwd&#125;"</span></span></span><br><span class="line"><span class="tag"><span class="attr">trust</span>=<span class="string">"true"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">command</span>=<span class="string">"pwd;./test.sh"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">outputproperty</span>=<span class="string">"output"</span> # <span class="attr">sh</span> 的输出，可用 $&#123;<span class="attr">output</span>&#125; 获取</span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>scp命令上传文件</p> <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">scp</span> <span class="attr">todir</span>=<span class="string">"$&#123;USERNAME&#125;:$&#123;PASSWORD&#125;@$&#123;SERVER&#125;:$&#123;DEST_DIR&#125;"</span> <span class="attr">trust</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fileset</span> <span class="attr">dir</span>=<span class="string">"$&#123;LOCAL_PATH&#125;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">name</span>=<span class="string">"build.properties"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">name</span>=<span class="string">"build.xml"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">name</span>=<span class="string">".idea/"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fileset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">scp</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>判断远程文件是否存在</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#判断文件是否存在</span></span><br><span class="line"><span class="keyword">if</span> [ -f <span class="string">"/data/filename"</span> ];<span class="keyword">then</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"文件存在"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"文件不存在"</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></li><li><p>shell脚本传参</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"脚本<span class="variable">$0</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"第一个参数<span class="variable">$1</span>"</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"第二个参数<span class="variable">$2</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 命令行输入</span></span><br><span class="line">$ ./test.sh 1 2</span><br><span class="line"><span class="comment">#shell中将会输出：</span></span><br><span class="line">脚本./test.sh <span class="comment"># $0获取到的是脚本路径以及脚本名</span></span><br><span class="line"><span class="comment"># 后面按顺序获取参数，当参数超过10个时(包括10个)，需要使用$&#123;10&#125;,$&#123;11&#125;....才能获取到参数</span></span><br><span class="line">第一个参数1</span><br><span class="line">第二个参数2</span><br></pre></td></tr></table></figure></li><li><p>shell脚本添加执行权限</p><p> chmod是权限管理命令change the permissions mode of a file的缩写。。</p><p> u代表所有者，x代表执行权限。 + 表示增加权限。</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">chmod u+x file.sh <span class="comment"># 就表示对当前目录下的file.sh文件的所有者增加可执行权限。</span></span><br></pre></td></tr></table></figure></li><li><p>shell脚本“syntax error:unexpected end of file”解决方案</p><p> 原因：该脚本在windows下编辑或者在windows打开保存过。</p><p> DOS下文件和Linux下文件格式差异问题导致的。</p><p> 在 idea 中右下角可以选择 LF 为换行标识。</p><p> 在 服务器可以使用vi修改文件格式，如下：</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi dos.txt</span><br><span class="line">:<span class="built_in">set</span> fileformat=unix</span><br><span class="line">:wq</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ant的使用，命令！&lt;/p&gt;
    
    </summary>
    
    
      <category term="java" scheme="https://JarvanKuo.github.io/categories/java/"/>
    
      <category term="构建工具" scheme="https://JarvanKuo.github.io/categories/java/%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="ant" scheme="https://JarvanKuo.github.io/tags/ant/"/>
    
  </entry>
  
</feed>
